---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

// Fetch anime reviews â€” exclude drafts, sort newest first
const animeReviews = (await getCollection('twin2-anime-reviews'))
  .filter(r => !r.data.draft)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime());

// Fetch game reviews â€” exclude drafts, sort newest first
const gameReviews = (await getCollection('twin2-game-reviews'))
  .filter(r => !r.data.draft)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
---

<BaseLayout
  title="Twin 2 Projects â€” Iremi Twins"
  description="Projects and apps by Twin 2 of the Iremi Twins."
>
  <main>
    <section class="portfolio section" style="padding-top: 8rem;">
      <div class="container">

        <p class="section__label">// twin 2</p>
        <h2 class="section__title">Twin 2's <span class="highlight">Projects</span></h2>

        <div class="portfolio__grid">

          <!-- â”€â”€ Genome Toolkit â”€â”€ -->
          <article class="project-card card" data-animate>
            <div class="project-card__header">
              <span class="project-card__type">Web App</span>
              <div class="project-card__links">
                <a href="/twin2/genome-toolkit" aria-label="Open Genome Toolkit">â†—</a>
              </div>
            </div>
            <a href="/twin2/genome-toolkit" style="text-decoration:none;color:inherit;">
              <h3>Genome Toolkit</h3>
              <p>Browser-based genomic data analysis â€” parse FASTA/FASTQ files, search motifs, visualize GC content, and compare variant datasets. Fully Built with Claude Opus 4.6</p>
            </a>
            <div class="project-card__tech">
              <span>React</span>
              <span>TypeScript</span>
              <span>Chart.js</span>
              <span>Zustand</span>
            </div>
          </article>

          <!-- â”€â”€ Placeholder card 2 â”€â”€ -->
          <article class="project-card card" data-animate>
            <div class="project-card__header">
              <span class="project-card__type">Coming Soon</span>
              <div class="project-card__links"></div>
            </div>
            <h3>Project Name</h3>
            <p>Details about this project coming soon.</p>
            <div class="project-card__tech">
              <span>TBD</span>
            </div>
          </article>

          <!-- â”€â”€ Placeholder card 3 â”€â”€ -->
          <article class="project-card card" data-animate>
            <div class="project-card__header">
              <span class="project-card__type">Coming Soon</span>
              <div class="project-card__links"></div>
            </div>
            <h3>Project Name</h3>
            <p>Details about this project coming soon.</p>
            <div class="project-card__tech">
              <span>TBD</span>
            </div>
          </article>

        </div>
      </div>
    </section>

    <!-- â”€â”€ Anime Reviews Section â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <section class="section" id="anime-reviews">
      <div class="container">
        <p class="section__label">// anime reviews</p>
        <h2 class="section__title">Anime <span class="highlight">Reviews</span></h2>

        {animeReviews.length > 0 ? (
          <div class="review__grid">
            {animeReviews.map(review => {
              const filled = Array.from({ length: review.data.rating }, (_, i) => i);
              const empty  = Array.from({ length: 5 - review.data.rating }, (_, i) => i);
              const displayDate = review.data.date.toLocaleDateString('en-GB', {
                month: 'short', year: 'numeric',
              });
              return (
                <article class="review-card card" data-animate>
                  {/* Cover image or placeholder */}
                  {review.data.coverImage ? (
                    <img src={review.data.coverImage} alt={review.data.title} class="review-card__cover" />
                  ) : (
                    <div class="review-card__cover--placeholder">ðŸŽ¬</div>
                  )}

                  {/* Star rating */}
                  <div class="review-card__stars">
                    {filled.map(() => <span class="review-card__star--filled">â˜…</span>)}
                    {empty.map(() => <span class="review-card__star--empty">â˜…</span>)}
                  </div>

                  {/* Title linked to the full review */}
                  <h3><a href={`/twin2/twin2-anime-reviews/${review.slug}`}>{review.data.title}</a></h3>

                  {/* Short description */}
                  <p class="review-card__desc">{review.data.description}</p>

                  {/* Date */}
                  <span class="review-card__date">{displayDate}</span>
                </article>
              );
            })}
          </div>
        ) : (
          <p style="color: var(--clr-muted);">No anime reviews yet â€” check back soon!</p>
        )}
      </div>
    </section>

    <!-- â”€â”€ Game Reviews Section â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <section class="section" id="game-reviews">
      <div class="container">
        <p class="section__label">// game reviews</p>
        <h2 class="section__title">Video Game <span class="highlight">Reviews</span></h2>

        {gameReviews.length > 0 ? (
          <div class="review__grid">
            {gameReviews.map(review => {
              const filled = Array.from({ length: review.data.rating }, (_, i) => i);
              const empty  = Array.from({ length: 5 - review.data.rating }, (_, i) => i);
              const displayDate = review.data.date.toLocaleDateString('en-GB', {
                month: 'short', year: 'numeric',
              });
              return (
                <article class="review-card card" data-animate>
                  {/* Cover image or placeholder */}
                  {review.data.coverImage ? (
                    <img src={review.data.coverImage} alt={review.data.title} class="review-card__cover" />
                  ) : (
                    <div class="review-card__cover--placeholder">ðŸŽ®</div>
                  )}

                  {/* Star rating */}
                  <div class="review-card__stars">
                    {filled.map(() => <span class="review-card__star--filled">â˜…</span>)}
                    {empty.map(() => <span class="review-card__star--empty">â˜…</span>)}
                  </div>

                  {/* Title linked to the full review */}
                  <h3><a href={`/twin2/twin2-game-reviews/${review.slug}`}>{review.data.title}</a></h3>

                  {/* Short description */}
                  <p class="review-card__desc">{review.data.description}</p>

                  {/* Date */}
                  <span class="review-card__date">{displayDate}</span>
                </article>
              );
            })}
          </div>
        ) : (
          <p style="color: var(--clr-muted);">No game reviews yet â€” check back soon!</p>
        )}
      </div>
    </section>

  </main>
</BaseLayout>
